define("discourse/plugins/discourse-data-explorer/discourse/routes/admin-plugins-explorer",["exports","discourse/lib/ajax"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=Discourse.Route.extend({controllerName:"admin-plugins-explorer",model:function(){var e=this.store.findAll("query"),n=(0,t.ajax)("/admin/plugins/explorer/schema.json",{cache:!0});return e.then(function(e){return e.forEach(function(e){return e.markNotDirty()}),n.then(function(t){return{model:e,schema:t}})}).catch(function(){return n.catch(function(){}),{model:null,schema:null,disallow:!0}})},setupController:function(e,t){e.setProperties(t)},actions:{refreshModel:function(){return this.refresh(),!1}}})}),Ember.TEMPLATES["javascripts/explorer-query-result"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["row","col"],"statements":[[7,"div"],[11,"class","result-info"],[9],[0,"\\n  "],[1,[29,"d-button",null,[["action","icon","label"],[[29,"action",[[24,0,[]],"downloadResultJson"],null],"download","explorer.download_json"]]],false],[0,"\\n  "],[1,[29,"d-button",null,[["action","icon","label"],[[29,"action",[[24,0,[]],"downloadResultCsv"],null],"download","explorer.download_csv"]]],false],[0,"\\n"],[10],[0,"\\n\\n"],[7,"div"],[11,"class","result-about"],[9],[0,"\\n  "],[1,[23,"resultCount"],false],[0,"\\n  "],[1,[23,"duration"],false],[0,"\\n"],[10],[0,"\\n\\n"],[7,"br"],[9],[10],[4,"if",[[25,["hasExplain"]]],null,{"statements":[[0,"  "],[7,"pre"],[11,"class","result-explain"],[9],[7,"code"],[9],[1,[25,["content","explain"]],false],[0,"\\n  "],[10],[10]],"parameters":[]},null],[0,""],[7,"br"],[9],[10],[0,"\\n\\n"],[7,"table"],[9],[0,"\\n  "],[7,"thead"],[9],[0,"\\n  "],[7,"tr"],[11,"class","headers"],[9],[0,"\\n"],[4,"each",[[25,["columnDispNames"]]],null,{"statements":[[0,"      "],[7,"th"],[9],[1,[24,2,[]],false],[10],[0,"\\n"]],"parameters":[2]},null],[0,"  "],[10],[0,"\\n  "],[10],[0,"\\n  "],[7,"tbody"],[9],[0,"\\n"],[4,"each",[[25,["rows"]]],null,{"statements":[[0,"    "],[1,[29,"query-row-content",null,[["row","fallbackTemplate","columnTemplates"],[[24,1,[]],[25,["fallbackTemplate"]],[25,["columnTemplates"]]]]],false],[0,"\\n"]],"parameters":[1]},null],[0,"  "],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/explorer-query-result"}}),Discourse.RAW_TEMPLATES["javascripts/explorer/topic"]=requirejs("discourse-common/lib/raw-handlebars").template({1:function(e,t,n,s,a){var r;return'  <a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"baseuri",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/t/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"topic.slug",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"topic.id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'"\n          >'+(null!=(r=n.get.call(null!=t?t:e.nullContext||{},"topic.fancy_title",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))?r:"")+"</a> ("+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"topic.posts_count",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+")\n"},3:function(e,t,n,s,a){return'  <a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"baseuri",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/t/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"</a>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){var r;return null!=(r=n.if.call(null!=t?t:e.nullContext||{},"topic",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),types:["PathExpression"],contexts:[t],data:a}))?r:""},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/badge"]=requirejs("discourse-common/lib/raw-handlebars").template({compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){return'<a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"baseuri",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/badges/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"badge.id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"badge.name",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'"\n   class="user-badge '+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"badge.badgeTypeClassName",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'"\n   title="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"badge.displayDescription",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'"\n   data-badge-name="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"badge.name",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">'+e.escapeExpression((n["icon-or-image"]||t&&t["icon-or-image"]||n.helperMissing).call(null!=t?t:e.nullContext||{},"badge.icon",{name:"icon-or-image",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'\n<span class="badge-display-name">'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"badge.displayName",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"</span></a>\n"},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/html"]=requirejs("discourse-common/lib/raw-handlebars").template({compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){var r;return(null!=(r=n.get.call(null!=t?t:e.nullContext||{},"value",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))?r:"")+"\n"},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/url"]=requirejs("discourse-common/lib/raw-handlebars").template({compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){return'<a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"href",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"target",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"</a>\n"},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/post"]=requirejs("discourse-common/lib/raw-handlebars").template({1:function(e,t,n,s,a){var r;return'  <aside class="quote" data-post="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.post_number",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'" data-topic="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.topic_id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">\n    <div class="title">\n      <div class="quote-controls">\n        <a href="/t/via-quote/'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.topic_id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.post_number",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'"\n          title="go to the quoted post"\n          class="quote-other-topic">\n        </a>\n      </div>\n      <a class="result-post-link" href="/t/'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.topic_id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.post_number",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">\n        '+e.escapeExpression((n.avatar||t&&t.avatar||n.helperMissing).call(null!=t?t:e.nullContext||{},"post",{name:"avatar",hash:{imageSize:"tiny"},hashTypes:{imageSize:"StringLiteral"},hashContexts:{imageSize:t},types:["PathExpression"],contexts:[t],data:a}))+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"post.username",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+":\n      </a>\n    </div>\n    <blockquote>\n      <p>\n        "+(null!=(r=n.get.call(null!=t?t:e.nullContext||{},"post.excerpt",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))?r:"")+"\n      </p>\n    </blockquote>\n  </aside>\n"},3:function(e,t,n,s,a){return"  "+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){var r;return null!=(r=n.if.call(null!=t?t:e.nullContext||{},"post",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),types:["PathExpression"],contexts:[t],data:a}))?r:""},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/reltime"]=requirejs("discourse-common/lib/raw-handlebars").template({compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){return e.escapeExpression((n.reltime||t&&t.reltime||n.helperMissing).call(null!=t?t:e.nullContext||{},"value",{name:"reltime",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"\n"},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/group"]=requirejs("discourse-common/lib/raw-handlebars").template({1:function(e,t,n,s,a){return'  <a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"baseuri",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/groups/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"group.name",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"group.name",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"</a>\n"},3:function(e,t,n,s,a){return"  "+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){var r;return null!=(r=n.if.call(null!=t?t:e.nullContext||{},"group",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),types:["PathExpression"],contexts:[t],data:a}))?r:""},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/text"]=requirejs("discourse-common/lib/raw-handlebars").template({compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){return e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"value",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"\n"},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/user"]=requirejs("discourse-common/lib/raw-handlebars").template({1:function(e,t,n,s,a){return'  <a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"baseuri",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/users/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"user.username",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'/activity"\n     data-user-card="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"user.username",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">'+e.escapeExpression((n.avatar||t&&t.avatar||n.helperMissing).call(null!=t?t:e.nullContext||{},"user",{name:"avatar",hash:{imageSize:"tiny"},hashTypes:{imageSize:"StringLiteral"},hashContexts:{imageSize:t},types:["PathExpression"],contexts:[t],data:a}))+" "+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"user.username",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"</a>\n"},3:function(e,t,n,s,a){return"  "+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){var r;return null!=(r=n.if.call(null!=t?t:e.nullContext||{},"user",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),types:["PathExpression"],contexts:[t],data:a}))?r:""},useData:!0}),Discourse.RAW_TEMPLATES["javascripts/explorer/category"]=requirejs("discourse-common/lib/raw-handlebars").template({1:function(e,t,n,s,a){return"  "+e.escapeExpression((n["category-link"]||t&&t["category-link"]||n.helperMissing).call(null!=t?t:e.nullContext||{},"category",{name:"category-link",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"\n"},3:function(e,t,n,s,a){return'  <a href="'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"baseuri",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"/t/"+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+'">'+e.escapeExpression(n.get.call(null!=t?t:e.nullContext||{},"id",{name:"get",hash:{},hashTypes:{},hashContexts:{},types:["PathExpression"],contexts:[t],data:a}))+"</a>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,s,a){var r;return null!=(r=n.if.call(null!=t?t:e.nullContext||{},"category",{name:"if",hash:{},hashTypes:{},hashContexts:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),types:["PathExpression"],contexts:[t],data:a}))?r:""},useData:!0}),Ember.TEMPLATES["javascripts/admin/plugins-explorer"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["query","err","pinfo"],"statements":[[4,"explorer-container",null,[["hideSchema","everEditing"],[[25,["hideSchema"]],[25,["everEditing"]]]],{"statements":[[4,"if",[[25,["disallow"]]],null,{"statements":[[0,"    "],[7,"h1"],[9],[1,[29,"i18n",["explorer.admins_only"],null],false],[10],[0,"\\n"]],"parameters":[]},{"statements":[[4,"unless",[[25,["selectedQueryId"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","query-list"],[9],[0,"\\n        "],[1,[29,"text-field",null,[["value","placeholderKey"],[[25,["search"]],"explorer.search_placeholder"]]],false],[0,"\\n        "],[1,[29,"d-button",null,[["action","icon","class"],[[29,"action",[[24,0,[]],"showCreate"],null],"plus","no-text btn-right"]]],false],[0,"\\n        "],[1,[29,"d-button",null,[["action","label","icon"],[[29,"action",[[24,0,[]],"importQuery"],null],"explorer.import.label","upload"]]],false],[0,"\\n      "],[10],[0,"\\n\\n"],[4,"if",[[25,["showCreate"]]],null,{"statements":[[0,"        "],[7,"div"],[11,"class","query-create"],[9],[0,"\\n          "],[1,[29,"text-field",null,[["value","placeholderKey"],[[25,["newQueryName"]],"explorer.create_placeholder"]]],false],[0,"\\n          "],[1,[29,"d-button",null,[["action","disabled","label","icon"],[[29,"action",[[24,0,[]],"create"],null],[25,["createDisabled"]],"explorer.create","plus"]]],false],[0,"\\n        "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"if",[[25,["othersDirty"]]],null,{"statements":[[0,"        "],[7,"div"],[11,"class","warning"],[9],[0,"\\n          "],[1,[29,"d-icon",["warning"],null],false],[0,"\\n          "],[1,[29,"i18n",["explorer.others_dirty"],null],false],[0,"\\n        "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"\\n"],[4,"if",[[25,["model","length"]]],null,{"statements":[[4,"unless",[[25,["selectedItem","fake"]]],null,{"statements":[[0,"        "],[7,"div"],[12,"class",[30,["query-edit ",[29,"if",[[25,["editName"]],"editing"],null]]]],[9],[0,"\\n"],[4,"if",[[25,["selectedItem"]]],null,{"statements":[[4,"if",[[25,["editing"]]],null,{"statements":[[0,"              "],[7,"div"],[11,"class","name"],[9],[0,"\\n                  "],[1,[29,"d-button",null,[["action","icon","class"],[[29,"action",[[24,0,[]],"goHome"],null],"chevron-left","previous"]]],false],[0,"\\n                "],[7,"div"],[11,"class","name-text-field"],[9],[0,"\\n                  "],[1,[29,"text-field",null,[["value"],[[25,["selectedItem","name"]]]]],false],[0,"\\n                "],[10],[0,"\\n              "],[10],[0,"\\n              "],[7,"div"],[11,"class","desc"],[9],[0,"\\n                "],[1,[29,"textarea",null,[["value","placeholder"],[[25,["selectedItem","description"]],[29,"i18n",["explorer.description_placeholder"],null]]]],false],[0,"\\n              "],[10],[0,"\\n"]],"parameters":[]},{"statements":[[0,"              "],[7,"div"],[11,"class","name"],[9],[0,"\\n                "],[1,[29,"d-button",null,[["action","icon","class"],[[29,"action",[[24,0,[]],"goHome"],null],"chevron-left","previous"]]],false],[0,"\\n                "],[7,"h1"],[9],[1,[25,["selectedItem","name"]],false],[0,"\\n"],[4,"unless",[[25,["editDisabled"]]],null,{"statements":[[0,"                    "],[7,"a"],[9],[1,[29,"d-icon",["pencil-alt"],null],false],[3,"action",[[24,0,[]],"editName"],[["class"],["edit-query-name"]]],[10],[0,"\\n"]],"parameters":[]},null],[0,"                "],[10],[0,"\\n              "],[10],[0,"\\n              "],[7,"div"],[11,"class","desc"],[9],[0,"\\n                "],[1,[25,["selectedItem","description"]],false],[0,"\\n              "],[10],[0,"\\n"]],"parameters":[]}],[0,"\\n"],[4,"if",[[25,["everEditing"]]],null,{"statements":[[0,"              "],[7,"div"],[12,"class",[30,["query-editor ",[29,"if",[[25,["hideSchema"]],"no-schema"],null]]]],[9],[0,"\\n                "],[7,"div"],[11,"class","panels-flex"],[9],[0,"\\n                  "],[7,"div"],[11,"class","editor-panel"],[9],[0,"\\n                    "],[1,[29,"ace-editor",null,[["content","mode"],[[25,["selectedItem","sql"]],"sql"]]],false],[0,"\\n                  "],[10],[0,"\\n                  "],[7,"div"],[11,"class","right-panel"],[9],[0,"\\n"],[4,"if",[[25,["hideSchema"]]],null,{"statements":[[0,"                      "],[1,[29,"d-button",null,[["action","icon","class"],[[29,"action",[[24,0,[]],"expandSchema"],null],"chevron-left","no-text unhide"]]],false],[0,"\\n"]],"parameters":[]},null],[0,"                    "],[7,"div"],[11,"class","schema"],[9],[0,"\\n                      "],[1,[29,"explorer-schema",null,[["schema","hideSchema"],[[25,["schema"]],[25,["hideSchema"]]]]],false],[0,"\\n                    "],[10],[0,"\\n                  "],[10],[0,"\\n                "],[10],[0,"\\n                "],[7,"div"],[11,"class","grippie"],[9],[0,"\\n                  "],[1,[29,"d-icon",["discourse-expand"],null],false],[0,"\\n                "],[10],[0,"\\n                "],[7,"div"],[11,"class","clear"],[9],[10],[0,"\\n              "],[10],[0,"\\n"]],"parameters":[]},{"statements":[[0,"              "],[7,"div"],[11,"class","sql"],[9],[0,"\\n                "],[1,[29,"hljs-code-view",null,[["value","codeClass"],[[25,["selectedItem","sql"]],"sql"]]],false],[0,"\\n              "],[10],[0,"\\n"]],"parameters":[]}],[0,"\\n            "],[7,"div"],[11,"class","clear"],[9],[10],[0,"\\n\\n            "],[7,"div"],[11,"class","pull-left"],[9],[0,"\\n"],[4,"if",[[25,["everEditing"]]],null,{"statements":[[0,"                "],[1,[29,"d-button",null,[["action","label","disabled"],[[29,"action",[[24,0,[]],"save"],null],"explorer.save",[25,["saveDisable"]]]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[4,"unless",[[25,["editDisabled"]]],null,{"statements":[[0,"                  "],[1,[29,"d-button",null,[["action","label","icon"],[[29,"action",[[24,0,[]],"editName"],null],"explorer.edit","pencil-alt"]]],false],[0,"\\n"]],"parameters":[]},null]],"parameters":[]}],[0,"              "],[1,[29,"d-button",null,[["action","label","disabled","icon"],[[29,"action",[[24,0,[]],"download"],null],"explorer.export",[25,["runDisabled"]],"download"]]],false],[0,"\\n            "],[10],[0,"\\n            "],[7,"div"],[11,"class","pull-right"],[9],[0,"\\n"],[4,"if",[[25,["selectedItem","destroyed"]]],null,{"statements":[[0,"                "],[1,[29,"d-button",null,[["action","class","icon","label"],[[29,"action",[[24,0,[]],"recover"],null],"","undo","explorer.recover"]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[4,"if",[[25,["everEditing"]]],null,{"statements":[[0,"                  "],[1,[29,"d-button",null,[["action","icon","label","disabled"],[[29,"action",[[24,0,[]],"discard"],null],"undo","explorer.undo",[25,["saveDisabled"]]]]],false],[0,"\\n"]],"parameters":[]},null],[4,"unless",[[25,["editDisabled"]]],null,{"statements":[[0,"                  "],[1,[29,"d-button",null,[["action","class","icon","label"],[[29,"action",[[24,0,[]],"destroy"],null],"btn-danger","trash-alt","explorer.delete"]]],false],[0,"\\n"]],"parameters":[]},null]],"parameters":[]}],[0,"            "],[10],[0,"\\n            "],[7,"div"],[11,"class","clear"],[9],[10],[0,"\\n"]],"parameters":[]},null],[0,"        "],[10],[0,"\\n\\n        "],[7,"form"],[11,"class","query-run"],[9],[0,"\\n"],[4,"if",[[25,["selectedItem","hasParams"]]],null,{"statements":[[0,"            "],[7,"div"],[11,"class","query-params"],[9],[0,"\\n"],[4,"each",[[25,["selectedItem","param_info"]]],null,{"statements":[[0,"                "],[1,[29,"param-input",null,[["params","info"],[[25,["selectedItem","params"]],[24,3,[]]]]],false],[0,"\\n"]],"parameters":[3]},null],[0,"            "],[10],[0,"\\n"]],"parameters":[]},null],[4,"if",[[25,["runDisabled"]]],null,{"statements":[[4,"if",[[25,["saveDisabled"]]],null,{"statements":[[0,"              "],[1,[29,"d-button",null,[["label","disabled","class"],["explorer.run","true","btn-primary"]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"              "],[1,[29,"d-button",null,[["action","icon","label","class"],[[29,"action",[[24,0,[]],"saverun"],null],"play","explorer.saverun","btn-primary"]]],false],[0,"\\n"]],"parameters":[]}]],"parameters":[]},{"statements":[[0,"            "],[1,[29,"d-button",null,[["action","icon","label","disabled","class","type"],[[29,"action",[[24,0,[]],"run"],null],"play","explorer.run",[25,["runDisabled"]],"btn-primary","submit"]]],false],[0,"\\n"]],"parameters":[]}],[0,"          "],[7,"label"],[11,"class","query-plan"],[9],[1,[29,"input",null,[["type","checked","name"],["checkbox",[25,["explain"]],"explain"]]],false],[0," "],[1,[29,"i18n",["explorer.explain_label"],null],false],[10],[0,"\\n        "],[3,"action",[[24,0,[]],"run"],[["on"],["submit"]]],[10],[0,"\\n\\n        "],[7,"hr"],[9],[10],[0,"\\n"]],"parameters":[]},null],[0,"      "],[1,[29,"conditional-loading-spinner",null,[["condition"],[[25,["loading"]]]]],false],[0,"\\n"],[4,"unless",[[25,["selectedItem","fake"]]],null,{"statements":[[4,"if",[[25,["results"]]],null,{"statements":[[0,"          "],[7,"div"],[11,"class","query-results"],[9],[0,"\\n"],[4,"if",[[25,["showResults"]]],null,{"statements":[[0,"              "],[1,[29,"query-result",null,[["query","content"],[[25,["selectedItem"]],[25,["results"]]]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[4,"each",[[25,["results","errors"]]],null,{"statements":[[0,"                "],[7,"pre"],[11,"class","query-error"],[9],[7,"code"],[9],[1,[24,2,[]],false],[10],[10],[0,""]],"parameters":[2]},null]],"parameters":[]}],[0,"          "],[10],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"\\n"],[4,"if",[[25,["showRecentQueries"]]],null,{"statements":[[0,"      "],[7,"div"],[11,"class","container"],[9],[0,"\\n        "],[7,"table"],[11,"class","recent-queries"],[9],[0,"\\n          "],[7,"thead"],[11,"class","heading-container"],[9],[0,"\\n            "],[7,"th"],[11,"class","col heading name"],[9],[0,"\\n              "],[7,"div"],[11,"class","heading-toggle"],[9],[0,"\\n                "],[1,[29,"directory-toggle",null,[["field","labelKey","order","asc"],["name","explorer.query_name",[25,["order"]],[25,["asc"]]]]],false],[0,"\\n              "],[3,"action",[[24,0,[]],"sortByProperty","name"]],[10],[0,"\\n            "],[10],[0,"\\n            "],[7,"th"],[11,"class","col heading created-by"],[9],[0,"\\n              "],[7,"div"],[11,"class","heading-toggle"],[9],[0,"\\n                "],[1,[29,"directory-toggle",null,[["field","labelKey","order","asc"],["username","explorer.query_user",[25,["order"]],[25,["asc"]]]]],false],[0,"\\n              "],[3,"action",[[24,0,[]],"sortByProperty","username"]],[10],[0,"\\n            "],[10],[0,"\\n            "],[7,"th"],[11,"class","col heading created-at"],[9],[0,"\\n              "],[7,"div"],[11,"class","heading-toggle"],[9],[0,"\\n                "],[1,[29,"directory-toggle",null,[["field","labelKey","order","asc"],["last_run_at","explorer.query_time",[25,["order"]],[25,["asc"]]]]],false],[0,"\\n              "],[3,"action",[[24,0,[]],"sortByProperty","last_run_at"]],[10],[0,"\\n            "],[10],[0,"\\n          "],[10],[0,"\\n          "],[7,"tr"],[9],[10],[0,"\\n          "],[7,"tbody"],[9],[0,"\\n"],[4,"each",[[25,["filteredContent"]]],null,{"statements":[[0,"              "],[7,"tr"],[11,"class","query-row"],[9],[0,"\\n                "],[7,"td"],[9],[0,"\\n                  "],[7,"a"],[12,"href",[30,["/admin/plugins/explorer/?id=",[24,1,["id"]]]]],[9],[0,"\\n                    "],[7,"b"],[11,"class","query-name"],[9],[1,[24,1,["name"]],false],[10],[0,"\\n                    "],[7,"medium"],[11,"class","query-desc"],[9],[1,[24,1,["description"]],false],[10],[0,"\\n                  "],[3,"action",[[24,0,[]],"scrollTop"]],[10],[0,"\\n                "],[10],[0,"\\n                "],[7,"td"],[11,"class","query-created-by"],[9],[0,"\\n"],[4,"if",[[24,1,["username"]]],null,{"statements":[[0,"                    "],[7,"a"],[12,"href",[30,["/users/",[24,1,["username"]],"/activity"]]],[9],[0,"\\n                      "],[7,"medium"],[9],[1,[24,1,["username"]],false],[10],[0,"\\n                    "],[10],[0,"\\n"]],"parameters":[]},null],[0,"                "],[10],[0,"\\n                "],[7,"td"],[11,"class","query-created-at"],[9],[0,"\\n"],[4,"if",[[24,1,["last_run_at"]]],null,{"statements":[[0,"                    "],[7,"medium"],[9],[0,"\\n                      "],[1,[29,"bound-date",[[24,1,["last_run_at"]]],null],false],[0,"\\n                    "],[10],[0,"\\n"]],"parameters":[]},{"statements":[[0,"                    "],[7,"medium"],[9],[0,"\\n                      "],[1,[29,"bound-date",[[24,1,["created_at"]]],null],false],[0,"\\n                    "],[10],[0,"\\n"]],"parameters":[]}],[0,"                "],[10],[0,"\\n              "],[10],[0,"\\n"]],"parameters":[1]},{"statements":[[0,"              "],[7,"br"],[9],[10],[0,"\\n              "],[7,"em"],[11,"class","no-search-results"],[9],[0," "],[1,[29,"i18n",["explorer.no_search_results"],null],false],[10],[0,"\\n"]],"parameters":[]}],[0,"          "],[10],[0,"\\n        "],[10],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[]},null],[0,"\\n      "],[7,"div"],[11,"class","explorer-pad-bottom"],[9],[10],[0,"\\n\\n"]],"parameters":[]},null]],"parameters":[]}]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/admin/plugins-explorer"}}),Ember.TEMPLATES["javascripts/admin/components/q-params/user_list"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[29,"user-selector",null,[["usernames"],[[25,["value"]]]]],false],[0,"\\n"],[7,"span"],[11,"class","param-name"],[9],[1,[25,["info","identifier"]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/components/q-params/user_list"}}),Ember.TEMPLATES["javascripts/admin/components/q-params/string"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[29,"text-field",null,[["value","type"],[[25,["value"]],"text"]]],false],[0,"\\n"],[7,"span"],[11,"class","param-name"],[9],[1,[25,["info","identifier"]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/components/q-params/string"}}),Ember.TEMPLATES["javascripts/admin/components/q-params/user_id"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[29,"user-selector",null,[["usernames","single"],[[25,["value"]],"true"]]],false],[0,"\\n"],[7,"span"],[11,"class","param-name"],[9],[1,[25,["info","identifier"]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/components/q-params/user_id"}}),Ember.TEMPLATES["javascripts/admin/components/q-params/generic"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[29,"text-field",null,[["value"],[[25,["value"]]]]],false],[0,"\\n"],[7,"span"],[11,"class","param-name"],[9],[1,[25,["info","identifier"]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/components/q-params/generic"}}),Ember.TEMPLATES["javascripts/admin/components/q-params/int"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[1,[29,"input",null,[["type","value"],["number",[25,["value"]]]]],false],[0,"\\n"],[7,"span"],[11,"class","param-name"],[9],[1,[25,["info","identifier"]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/components/q-params/int"}}),Ember.TEMPLATES["javascripts/admin/components/q-params/boolean"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"if",[[25,["info","nullable"]]],null,{"statements":[[0,"  "],[1,[29,"combo-box",null,[["valueAttribute","value","nameProperty","content"],["id",[25,["value"]],"name",[25,["boolTypes"]]]]],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"  "],[1,[29,"input",null,[["type","checked"],["checkbox",[25,["valueBool"]]]]],false],[0,"\\n"]],"parameters":[]}],[7,"span"],[11,"class","param-name"],[9],[1,[25,["info","identifier"]],false],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/admin/components/q-params/boolean"}}),Ember.TEMPLATES["javascripts/modal/import-query"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[4,"d-modal-body",null,[["title"],["explorer.import.modal"]],{"statements":[[0,"  "],[7,"form"],[9],[0,"\\n    "],[7,"div"],[11,"class","modal-body"],[9],[0,"\\n      "],[1,[29,"json-file-uploader",null,[["value","extension"],[[25,["queryFile"]],".dcquery.json"]]],false],[0,"\\n    "],[10],[0,"\\n    "],[7,"div"],[11,"class","modal-footer"],[9],[0,"\\n      "],[1,[29,"d-button",null,[["class","action","type","disabled","icon","label"],["btn-primary","doImport","submit",[25,["notReady"]],"plus","explorer.import.label"]]],false],[0,"\\n    "],[10],[0,"\\n  "],[3,"action",[[24,0,[]],"dummy"],[["on"],["submit"]]],[10],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/modal/import-query"}}),Ember.TEMPLATES["javascripts/components/explorer-schema-enuminfo"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["enum"],"statements":[[4,"each",[[25,["enuminfo"]]],null,{"statements":[[0,"  "],[7,"li"],[12,"value",[30,[[24,1,["value"]]]]],[9],[0,"\\n    "],[1,[24,1,["name"]],false],[0,"\\n  "],[10],[0,"\\n"]],"parameters":[1]},null]],"hasEval":false}',meta:{moduleName:"javascripts/components/explorer-schema-enuminfo"}}),Ember.TEMPLATES["javascripts/components/explorer-schema"]=Ember.HTMLBars.template({id:null,
block:'{"symbols":["table"],"statements":[[7,"div"],[12,"class",[30,[[29,"if",[[25,["hideSchema"]],"hidden"],null]]]],[9],[0,"\\n  "],[1,[29,"text-field",null,[["value","placeholderKey"],[[25,["filter"]],"explorer.schema.filter"]]],false],[0,"\\n  "],[1,[29,"d-button",null,[["action","icon","class"],[[29,"action",[[24,0,[]],"collapseSchema"],null],"chevron-right","no-text"]]],false],[0,"\\n  "],[1,[29,"conditional-loading-spinner",null,[["condition"],[[25,["loading"]]]]],false],[0,"\\n  "],[7,"div"],[11,"class","schema-container"],[9],[0,"\\n    "],[7,"ul"],[9],[0,"\\n"],[4,"each",[[25,["filteredTables"]]],null,{"statements":[[0,"        "],[1,[29,"explorer-schema-onetable",null,[["table"],[[24,1,[]]]]],false],[0,"\\n"]],"parameters":[1]},null],[0,"    "],[10],[0,"\\n  "],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/explorer-schema"}}),Ember.TEMPLATES["javascripts/components/explorer-schema-onetable"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["col"],"statements":[[7,"div"],[11,"class","schema-table-name"],[9],[0,"\\n"],[4,"if",[[25,["open"]]],null,{"statements":[[0,"    "],[1,[29,"d-icon",["caret-down"],null],false],[0,"\\n"]],"parameters":[]},{"statements":[[0,"    "],[1,[29,"d-icon",["caret-right"],null],false],[0,"\\n"]],"parameters":[]}],[0,"  "],[1,[25,["table","name"]],false],[0,"\\n"],[10],[0,"\\n"],[7,"div"],[11,"class","schema-table-cols"],[9],[0,"\\n"],[4,"if",[[25,["open"]]],null,{"statements":[[0,"    "],[7,"dl"],[9],[0,"\\n"],[4,"each",[[25,["table","columns"]]],null,{"statements":[[0,"      "],[7,"div"],[9],[0,"\\n      "],[7,"dt"],[12,"class",[30,[[29,"if",[[24,1,["sensitive"]],"sensitive"],null]]]],[12,"title",[30,[[29,"if",[[24,1,["sensitive"]],[29,"i18n",["explorer.schema.sensitive"],null]],null]]]],[9],[0,"\\n"],[4,"if",[[24,1,["sensitive"]]],null,{"statements":[[0,"          "],[1,[29,"d-icon",["warning"],null],false],[0,"\\n"]],"parameters":[]},null],[0,"        "],[1,[24,1,["column_name"]],false],[0,"\\n      "],[10],[0,"\\n      "],[7,"dd"],[9],[0,"\\n        "],[1,[24,1,["data_type"]],false],[0,"\\n"],[4,"if",[[24,1,["havetypeinfo"]]],null,{"statements":[[0,"          "],[7,"br"],[9],[10],[0,"\\n"],[4,"if",[[24,1,["havepopup"]]],null,{"statements":[[0,"            "],[7,"div"],[11,"class","popup-info"],[9],[0,"\\n              "],[1,[29,"d-icon",["info"],null],false],[0,"\\n              "],[7,"div"],[11,"class","popup"],[9],[0,"\\n                "],[1,[24,1,["column_desc"]],false],[0,"\\n"],[4,"if",[[24,1,["enum"]]],null,{"statements":[[0,"                  "],[1,[29,"explorer-schema-enuminfo",null,[["col"],[[24,1,[]]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"              "],[10],[0,"\\n            "],[10],[0,"\\n"]],"parameters":[]},null],[0,"          "],[7,"span"],[11,"class","schema-typenotes"],[9],[0,"\\n            "],[1,[24,1,["notes"]],false],[0,"\\n          "],[10],[0,"\\n"]],"parameters":[]},null],[0,"      "],[10],[0,"\\n      "],[10],[0,"\\n"]],"parameters":[1]},null],[0,"    "],[10],[0,"\\n"]],"parameters":[]},null],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/explorer-schema-onetable"}}),Ember.TEMPLATES["javascripts/components/json-file-uploader"]=Ember.HTMLBars.template({id:null,block:'{"symbols":[],"statements":[[7,"div"],[11,"class","jsfu-shade-container"],[9],[0,"\\n  "],[7,"div"],[11,"class","jsfu-file"],[9],[0,"\\n    "],[7,"input"],[11,"id","js-file-input"],[11,"style","display:none;"],[12,"accept",[23,"accept"]],[11,"type","file"],[9],[10],[0,"\\n    "],[1,[29,"d-button",null,[["class","action","class","icon","label"],["fileSelect",[29,"action",[[24,0,[]],"selectFile"],null],"","upload","upload_selector.select_file"]]],false],[0,"\\n    "],[1,[29,"conditional-loading-spinner",null,[["condition","size"],[[25,["loading"]],"small"]]],false],[0,"\\n  "],[10],[0,"\\n  "],[7,"div"],[11,"class","jsfu-separator"],[9],[0,"\\n    "],[7,"small"],[9],[0,"\\n      "],[1,[29,"i18n",["alternation"],null],false],[0,"\\n    "],[10],[0,"\\n  "],[10],[0,"\\n  "],[7,"div"],[11,"class","jsfu-paste"],[9],[0,"\\n    "],[1,[29,"textarea",null,[["value"],[[25,["value"]]]]],false],[0,"\\n  "],[10],[0,"\\n  "],[7,"div"],[12,"class",[30,["jsfu-shade ",[29,"if",[[25,["hover"]],"","hidden"],null]]]],[9],[7,"span"],[11,"class","text"],[9],[1,[29,"d-icon",["upload"],null],false],[10],[10],[0,"\\n"],[10],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/components/json-file-uploader"}}),define("discourse/plugins/discourse-data-explorer/discourse/models/query",["exports","ember-addons/ember-computed-decorators","discourse/models/rest"],function(e,t,n){"use strict";function s(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var a,r,i,l,o,u,c=n.default.extend((a=(0,t.on)("init"),r=(0,t.on)("init"),i=(0,t.observes)("param_info"),l=(0,t.observes)("name","description","sql"),o=(0,t.default)("id"),u={dirty:!1,params:{},results:null,_init:function(){this._super.apply(this,arguments),this.set("dirty",!1)},_initParams:function(){this.resetParams()},markDirty:function(){this.set("dirty",!0)},markNotDirty:function(){this.set("dirty",!1)},hasParams:Ember.computed.reads("param_info.length"),resetParams:function(){var e={},t=this.params;(this.param_info||[]).forEach(function(n){var s=n.identifier;t[n.identifier]?e[s]=t[s]:null!==n.default?e[s]=n.default:"boolean"===n.type?e[s]="false":e[s]=""}),this.set("params",e)},downloadUrl:function(e){return Discourse.getURL("/admin/plugins/explorer/queries/"+e+".json?export=1")},createProperties:function(){return this.sql?this.updateProperties():this.getProperties("name")},updateProperties:function(){var e=this.getProperties(c.updatePropertyNames);return this.destroyed&&(e.id=this.id),e}},s(u,"_init",[a],Object.getOwnPropertyDescriptor(u,"_init"),u),s(u,"_initParams",[r,i],Object.getOwnPropertyDescriptor(u,"_initParams"),u),s(u,"markDirty",[l],Object.getOwnPropertyDescriptor(u,"markDirty"),u),s(u,"downloadUrl",[o],Object.getOwnPropertyDescriptor(u,"downloadUrl"),u),u));c.reopenClass({updatePropertyNames:["name","description","sql","created_by","created_at","last_run_at"]}),e.default=c}),define("discourse/plugins/discourse-data-explorer/discourse/explorer-route-map",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={resource:"admin.adminPlugins",path:"/plugins",map:function(){this.route("explorer")}}}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema-onetable",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";function n(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var s,a,r;e.default=Ember.Component.extend((s=(0,t.on)("didInsertElement"),a=(0,t.on)("willDestroyElement"),r={classNameBindings:[":schema-table","open"],tagName:"li",open:Ember.computed.reads("table.open"),_bindClicks:function(){var e=this;$(this.element).find(".schema-table-name").click(function(t){e.set("table.open",!e.table.open),t.preventDefault()})},_cleanup:function(){$(this.element).find(".schema-table-name").off("click")}},n(r,"_bindClicks",[s],Object.getOwnPropertyDescriptor(r,"_bindClicks"),r),n(r,"_cleanup",[a],Object.getOwnPropertyDescriptor(r,"_cleanup"),r),r))}),define("discourse/plugins/discourse-data-explorer/discourse/components/query-result",["exports","discourse/lib/ajax","discourse/models/badge","discourse-common/lib/get-owner","ember-addons/ember-computed-decorators"],function(e,t,n,s,a){"use strict";function r(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}function i(){return"xxxxxxxx".replace(/[xy]/g,function(){return(16*Math.random()|0).toString(16)})}function l(e,t){var n={};return e.forEach(function(e){n[e.id]=t?t.create(e):e}),n}Object.defineProperty(e,"__esModule",{value:!0});var o,u,c,d,p,m,h,f,b,g,x,y=Ember.Component.extend((o=(0,a.default)("content.result_count"),u=(0,a.default)("content.duration"),c=(0,a.default)("params.[]"),d=(0,a.default)("content","columns.[]"),p=(0,a.default)("content","columns.[]"),m=(0,a.default)("content.relations.user"),h=(0,a.default)("content.relations.badge"),f=(0,a.default)("content.relations.post"),b=(0,a.default)("content.relations.topic"),g=(0,a.default)("site.groups"),x={layoutName:"explorer-query-result",rows:Ember.computed.alias("content.rows"),columns:Ember.computed.alias("content.columns"),params:Ember.computed.alias("content.params"),explainText:Ember.computed.alias("content.explain"),hasExplain:Ember.computed.notEmpty("content.explain"),resultCount:function(e){return e===this.get("content.default_limit")?I18n.t("explorer.max_result_count",{count:e}):I18n.t("explorer.result_count",{count:e})},colCount:Ember.computed.reads("content.columns.length"),duration:function(e){return I18n.t("explorer.run_time",{value:I18n.toNumber(e,{precision:1})})},parameterAry:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({key:n,value:e[n]});return t},columnDispNames:function(e,t){return t?t.map(function(e){if(e.endsWith("_id"))return e.slice(0,-3);var t=e.indexOf("$");return t>=0?e.substring(t+1):e}):[]},fallbackTemplate:function(){return(0,s.getOwner)(this).lookup("template:explorer/text.raw")},columnTemplates:function(e,t){var n=this;return t?t.map(function(e,t){var a="text";n.get("content.colrender")[t]&&(a=n.get("content.colrender")[t]);var r=(0,s.getOwner)(n).lookup("template:explorer/"+a+".raw");return r||(r=Discourse.RAW_TEMPLATES["javascripts/explorer/"+a]),{name:a,template:r}}):[]},transformedUserTable:function(e){return l(e)},transformedBadgeTable:function(e){return l(e,n.default)},transformedPostTable:function(e){return l(e)},transformedTopicTable:function(e){return l(e)},transformedGroupTable:function(e){return l(e)},lookupUser:function(e){return this.transformedUserTable[e]},lookupBadge:function(e){return this.transformedBadgeTable[e]},lookupPost:function(e){return this.transformedPostTable[e]},lookupTopic:function(e){return this.transformedTopicTable[e]},lookupGroup:function(e){return this.transformedGroupTable[e]},lookupCategory:function(e){return this.site.get("categoriesById")[e]},downloadResult:function(e){function n(e,t){var n=void 0;n=document.createElement("input"),n.setAttribute("name",e),n.setAttribute("value",t),a.appendChild(n)}var s=i();window.open("data:text/html;base64,"+btoa("<style>body{font-size:36px;display:flex;justify-content:center;align-items:center;}</style><body>Click anywhere to close this window once the download finishes.<script>window.onclick=function(){window.close()};<\/script>"),s);var a=document.createElement("form");a.setAttribute("id","query-download-result"),a.setAttribute("method","post"),a.setAttribute("action",Discourse.getURL("/admin/plugins/explorer/queries/"+this.get("query.id")+"/run."+e+"?download=1")),a.setAttribute("target",s),a.setAttribute("style","display:none;"),n("params",JSON.stringify(this.params)),n("explain",this.hasExplain),n("limit","1000000"),(0,t.ajax)("/session/csrf.json").then(function(e){n("authenticity_token",e.csrf),document.body.appendChild(a),a.submit(),Ember.run.schedule("afterRender",function(){return document.body.removeChild(a)})})},actions:{downloadResultJson:function(){this.downloadResult("json")},downloadResultCsv:function(){this.downloadResult("csv")}}},r(x,"resultCount",[o],Object.getOwnPropertyDescriptor(x,"resultCount"),x),r(x,"duration",[u],Object.getOwnPropertyDescriptor(x,"duration"),x),r(x,"parameterAry",[c],Object.getOwnPropertyDescriptor(x,"parameterAry"),x),r(x,"columnDispNames",[d],Object.getOwnPropertyDescriptor(x,"columnDispNames"),x),r(x,"fallbackTemplate",[a.default],Object.getOwnPropertyDescriptor(x,"fallbackTemplate"),x),r(x,"columnTemplates",[p],Object.getOwnPropertyDescriptor(x,"columnTemplates"),x),r(x,"transformedUserTable",[m],Object.getOwnPropertyDescriptor(x,"transformedUserTable"),x),r(x,"transformedBadgeTable",[h],Object.getOwnPropertyDescriptor(x,"transformedBadgeTable"),x),r(x,"transformedPostTable",[f],Object.getOwnPropertyDescriptor(x,"transformedPostTable"),x),r(x,"transformedTopicTable",[b],Object.getOwnPropertyDescriptor(x,"transformedTopicTable"),x),r(x,"transformedGroupTable",[g],Object.getOwnPropertyDescriptor(x,"transformedGroupTable"),x),x));e.default=y}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema-enuminfo",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s;e.default=Ember.Component.extend((n=(0,t.default)("col.enum"),s={tagName:"ol",enuminfo:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({value:n,name:e[n]});return t}},function(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}(s,"enuminfo",[n],Object.getOwnPropertyDescriptor(s,"enuminfo"),s),s))}),define("discourse/plugins/discourse-data-explorer/discourse/components/hljs-code-view",["exports","ember-addons/ember-computed-decorators","discourse/lib/debounce","discourse/lib/highlight-syntax","discourse-common/lib/buffered-render"],function(e,t,n,s,a){"use strict";function r(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var i,l,o,u;e.default=Ember.Component.extend((0,a.bufferedRender)((i=(0,t.observes)("value"),l=(0,t.on)("didInsertElement"),o={buildBuffer:function(e){e.push("<pre><code class='"+this.codeClass+"'>"),e.push(Handlebars.Utils.escapeExpression(this.value)),e.push("</code></pre>")},_refreshHighlight:(0,n.default)(function(){this.rerenderBuffer()},50),_applyHighlight:function(){(0,s.default)($(this.element))}},r(o,"_refreshHighlight",[i],(u=Object.getOwnPropertyDescriptor(o,"_refreshHighlight"),u=u?u.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return u}}),o),r(o,"_applyHighlight",[l],Object.getOwnPropertyDescriptor(o,"_applyHighlight"),o),o)))}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-schema",["exports","ember-addons/ember-computed-decorators","discourse/lib/debounce"],function(e,t,n){"use strict";function s(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var a,r,i,l,o,u;e.default=Ember.Component.extend((a=(0,t.default)("schema"),r=(0,t.default)("filter"),i=(0,t.observes)("filter"),l=(0,t.observes)("filter"),o={actions:{collapseSchema:function(){this.set("hideSchema",!0)}},transformedSchema:function(e){for(var t in e)e.hasOwnProperty(t)&&e[t].forEach(function(e){var t=[];e.primary&&t.push("primary key"),e.is_nullable&&t.push("null"),e.column_default&&t.push("default "+e.column_default),e.fkey_info&&t.push("fkey "+e.fkey_info),e.denormal&&t.push("denormal "+e.denormal);var n=t.join(", ");n&&(e.notes=n),(e.enum||e.column_desc)&&(e.havepopup=!0),e.havetypeinfo=!!(e.notes||e.enum||e.column_desc)});return e},rfilter:function(e){if(!Ember.isBlank(e))return new RegExp(e)},filterTables:function(e){var t=[],n=this.rfilter,s=!!n;for(var a in e)e.hasOwnProperty(a)&&(s?n.source===a||n.source+"s"===a?t.unshift({name:a,columns:e[a],open:s}):n.test(a)?t.push({name:a,columns:e[a],open:s}):function(){var r=[];e[a].forEach(function(e){n.source===e.column_name?r.unshift(e):n.test(e.column_name)&&r.push(e)}),Ember.isEmpty(r)||t.push({name:a,columns:r,open:s})}():t.push({name:a,columns:e[a],open:!1}));return t},triggerFilter:(0,n.default)(function(){this.set("filteredTables",this.filterTables(this.transformedSchema)),this.set("loading",!1)},500),setLoading:function(){this.set("loading",!0)},init:function(){this._super.apply(this,arguments),this.set("loading",!0),this.triggerFilter()}},s(o,"transformedSchema",[a],Object.getOwnPropertyDescriptor(o,"transformedSchema"),o),s(o,"rfilter",[r],Object.getOwnPropertyDescriptor(o,"rfilter"),o),s(o,"triggerFilter",[i],(u=Object.getOwnPropertyDescriptor(o,"triggerFilter"),u=u?u.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return u}}),o),s(o,"setLoading",[l],Object.getOwnPropertyDescriptor(o,"setLoading"),o),o))}),define("discourse/plugins/discourse-data-explorer/discourse/components/json-file-uploader",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";function n(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var s,a,r,i;e.default=Ember.Component.extend((s=(0,t.on)("didInsertElement"),a=(0,t.default)("extension"),r=(0,t.observes)("destination","expectedRootObjectName"),i={fileInput:null,loading:!1,expectedRootObjectName:null,hover:0,classNames:["json-uploader"],_initialize:function(){var e=this,t=$(this.element),n=this.element.querySelector("#js-file-input");this.set("fileInput",n),$(n).on("change",function(){return e.fileSelected(e.files)}),t.on("dragover",function(e){return e.preventDefault&&e.preventDefault(),!1}),t.on("dragenter",function(t){return t.preventDefault&&t.preventDefault(),e.set("hover",e.hover+1),!1}),t.on("dragleave",function(t){return t.preventDefault&&t.preventDefault(),e.set("hover",e.hover-1),!1}),t.on("drop",function(t){return t.preventDefault&&t.preventDefault(),e.set("hover",0),e.fileSelected(t.dataTransfer.files),!1})},accept:function(e){return".json,application/json,application/x-javascript,text/json"+(e?","+e:"")},setReady:function(){var e=void 0;try{e=JSON.parse(this.value)}catch(e){return void this.set("ready",!1)}var t=e[this.expectedRootObjectName];null!==t&&void 0!==t?this.set("ready",!0):this.set("ready",!1)},actions:{selectFile:function(){$(this.fileInput).click()}},fileSelected:function(e){for(var t=this,n=[],s=0;s<e.length;s++)n[s]=e[s];var a=/\.(json|txt)$/;n=n.filter(function(e){return!!a.test(e.name)||"text/plain"===e.type});var r=e[0];this.set("loading",!0);var i=new FileReader;i.onload=function(e){t.setProperties({value:e.target.result,loading:!1})},i.readAsText(r)}},n(i,"_initialize",[s],Object.getOwnPropertyDescriptor(i,"_initialize"),i),n(i,"accept",[a],Object.getOwnPropertyDescriptor(i,"accept"),i),n(i,"setReady",[r],Object.getOwnPropertyDescriptor(i,"setReady"),i),i))}),define("discourse/plugins/discourse-data-explorer/discourse/components/explorer-container",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";function n(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var s,a,r;e.default=Ember.Component.extend((s=(0,t.observes)("hideSchema"),a=(0,t.observes)("everEditing"),r={_onHideSchema:function(){this.appEvents.trigger("ace:resize")},_onInsertEditor:function(){var e=this;Ember.run.schedule("afterRender",this,function(){return e._bindControls()})},_bindControls:function(){var e=this;if("inDOM"===this._state){var t=$(".query-editor");if(t.length){var n=this.grippie;n&&n.off("mousedown mousemove mouseup");var s=t.find(".grippie"),a=t.find(".panels-flex"),r=$(document),i=a.width(),l=a.height();this.set("grippie",s);var o=function(t){var n=e.startY-t.screenY,r=e.startX-t.screenX,o=Math.max(l,e.startHeight-n),u=Math.max(i,e.startWidth-r);a.height(o),a.width(u),s.width(u),e.appEvents.trigger("ace:resize")},u=function(t){t.preventDefault(),Ember.run.throttle(e,o,t,20)}.bind(this),c=function(){r.off("mousemove",u),r.off("mouseup",c),e.setProperties({startY:null,startX:null,startHeight:null,startWidth:null})}.bind(this);s.on("mousedown",function(t){e.setProperties({startY:t.screenY,startX:t.screenX,startHeight:a.height(),startWidth:a.width()}),r.on("mousemove",u),r.on("mouseup",c),t.preventDefault()})}}},didInsertElement:function(){this._super.apply(this,arguments),this._bindControls()},willDestroyElement:function(){this._super.apply(this,arguments),this.everEditing&&(this.grippie&&this.grippie.off("mousedown"),this.set("grippie",null))}},n(r,"_onHideSchema",[s],Object.getOwnPropertyDescriptor(r,"_onHideSchema"),r),n(r,"_onInsertEditor",[a],Object.getOwnPropertyDescriptor(r,"_onInsertEditor"),r),r))}),define("discourse/plugins/discourse-data-explorer/discourse/components/param-input",["exports","ember-addons/ember-computed-decorators"],function(e,t){"use strict";function n(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}function s(){try{var e=document.createElement("input");return e.attributes.type="time",e.attributes.type="date",!0}catch(e){return!1}}Object.defineProperty(e,"__esModule",{value:!0});var a,r,i,l,o=Discourse.Category,u={int:"int",bigint:"int",boolean:"boolean",string:"generic",time:"generic",date:"generic",datetime:"generic",double:"string",user_id:"user_id",post_id:"string",topic_id:"generic",category_id:"generic",group_id:"generic",badge_id:"generic",int_list:"generic",string_list:"generic",user_list:"user_list"};e.default=Ember.Component.extend((a=(0,t.default)("value","info.type","info.nullable"),r=(0,t.default)("info.type"),i=(0,t.default)("layoutType"),l={classNameBindings:["valid:valid:invalid",":param"],boolTypes:[{name:I18n.t("explorer.types.bool.true"),id:"Y"},{name:I18n.t("explorer.types.bool.false"),id:"N"},{name:I18n.t("explorer.types.bool.null_"),id:"#null"}],value:Ember.computed("params","info.identifier",{get:function(){return this.params[this.get("info.identifier")]},set:function(e,t){return this.params[this.get("info.identifier")]=t.toString(),t}}),valueBool:Ember.computed("params","info.identifier",{get:function(){return"false"!==this.params[this.get("info.identifier")]},set:function(e,t){return t=!!t,this.params[this.get("info.identifier")]=t.toString(),t}}),valid:function(e,t,n){if(Ember.isEmpty(e))return n;var s=parseInt(e,10),a=!isNaN(s)&&s<2147483648&&s>-2147483649,r=/^\d+$/.test(e);switch(t){case"int":return/^-?\d+$/.test(e)&&a;case"bigint":return/^-?\d+$/.test(e)&&!isNaN(s);case"boolean":return/^Y|N|#null|true|false/.test(e);case"double":return!isNaN(parseFloat(e))||/^(-?)Inf(inity)?$/i.test(e)||/^(-?)NaN$/i.test(e);case"int_list":return e.split(",").every(function(e){return/^(-?\d+|null)$/.test(e.trim())});case"post_id":return r||/\d+\/\d+(\?u=.*)?$/.test(e);case"category_id":if(r||e===e.dasherize()||this.set("value",e.dasherize()),r)return!!this.site.categories.find(function(e){return e.id===s});if(/\//.test(e)){var i=/(.*)\/(.*)/.exec(e);if(!i)return!1;return!!o.findBySlug(i[2].dasherize(),i[1].dasherize())}return!!o.findBySlug(e.dasherize());case"group_id":var l=this.site.get("groups");return r?!!l.find(function(e){return e.id===s}):!!l.find(function(t){return t.name===e})}return!0},layoutType:function(e){return"time"!==e&&"date"!==e||s()?u[e]?u[e]:"generic":"string"},layoutName:function(e){return"admin/components/q-params/"+e}},n(l,"valid",[a],Object.getOwnPropertyDescriptor(l,"valid"),l),n(l,"layoutType",[r],Object.getOwnPropertyDescriptor(l,"layoutType"),l),n(l,"layoutName",[i],Object.getOwnPropertyDescriptor(l,"layoutName"),l),l))}),define("discourse/plugins/discourse-data-explorer/discourse/components/query-row-content",["exports","discourse/helpers/category-link","discourse/lib/formatter","discourse-common/lib/buffered-render","discourse-common/lib/icon-library"],function(e,t,n,s,a){"use strict";function r(e,t){if(e=Ember.get(t.contexts[0],e),Ember.isEmpty(e))return"";if(e.indexOf("fa-")>-1){var n=(0,a.iconHTML)((0,a.convertIconClass)(e));return new Handlebars.SafeString(n)}return new Handlebars.SafeString("<img src='"+e+"'>")}function i(e,n){var s=Ember.get(n.contexts[0],e);return(0,t.categoryLinkHTML)(s,{allowUncategorized:!0})}function l(e,t){var s=Ember.get(t.contexts[0],e);return new Handlebars.SafeString((0,n.autoUpdatingRelativeAge)(new Date(s),{title:!0}))}function o(e){var t=e,n=e,s=e.split(/,(.+)/);return s.length>1&&(n=s[0],t=s[1]),[t,n]}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function e(e,t){var n=[],s=!0,a=!1,r=void 0;try{for(var i,l=e[Symbol.iterator]();!(s=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);s=!0);}catch(e){a=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=Handlebars.Utils.escapeExpression,d=Ember.Component.extend((0,s.bufferedRender)({tagName:"tr",buildBuffer:function(e){var t=this.row,n=this.parentView,s=this.fallbackTemplate,a={"icon-or-image":r,"category-link":i,reltime:l},d=this.columnTemplates.map(function(e,r){var i=t[r],l=parseInt(i),d={value:i,id:l,baseuri:"/"===Discourse.BaseUri?"":Discourse.BaseUri},p={};if(null===t[r])return"NULL";if("text"===e.name)return c(t[r]);if(n["lookup"+e.name.capitalize()]&&(d[e.name]=n["lookup"+e.name.capitalize()](l)),"url"===e.name){var m=o(i),h=u(m,2),f=h[0],b=h[1];d.href=f,d.target=b}"category"!==e.name&&"badge"!==e.name&&"reltime"!==e.name||(p.helpers=a);try{return new Handlebars.SafeString((e.template||s)(d,p))}catch(e){return"error"}});e.push("<td>"+d.join("</td><td>")+"</td>")}}));e.default=d}),define("discourse/plugins/discourse-data-explorer/discourse/lib/binary-search",["exports"],function(e){"use strict";function t(e,t,n){for(var s=0,a=e.length-1,r=void 0,i=n||"id";s<=a;){if(r=Math.floor((s+a)/2),Ember.get(e[r],i)===t)return r;Ember.get(e[r],i)<t?s=r+1:a=r-1}return-1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=t}),define("discourse/plugins/discourse-data-explorer/discourse/initializers/initialize-data-explorer",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"initialize-data-explorer",initialize:function(e){e.lookup("store:main").addPluralization("query","queries"),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var s=n.indexOf(e,t);return-1!==s&&s===t})}}}),define("discourse/plugins/discourse-data-explorer/discourse/controllers/admin-plugins-explorer",["exports","discourse/lib/show-modal","discourse/plugins/discourse-data-explorer/discourse/models/query","discourse/lib/ajax-error","discourse/lib/ajax","ember-addons/ember-computed-decorators"],function(e,t,n,s,a,r){"use strict";function i(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}Object.defineProperty(e,"__esModule",{value:!0});var l,o,u,c,d,p,m=n.default.create({name:"No queries",fake:!0});e.default=Ember.Controller.extend((l=(0,r.default)("search","sortBy"),o=(0,r.default)("newQueryName"),u=(0,r.default)("selectedQueryId"),c=(0,r.default)("selectedItem","selectedItem.dirty"),d=(0,r.observes)("editing"),p={queryParams:{selectedQueryId:"id"},selectedQueryId:null,editDisabled:!1,showResults:!1,hideSchema:!1,loading:!1,explain:!1,saveDisabled:Ember.computed.not("selectedItem.dirty"),runDisabled:Ember.computed.alias("selectedItem.dirty"),results:Ember.computed.alias("selectedItem.results"),asc:null,order:null,editing:!1,everEditing:!1,showRecentQueries:!0,sortBy:["last_run_at:desc"],sortedQueries:Ember.computed.sort("model","sortBy"),filteredContent:function(e){var t=new RegExp(e,"i");return this.sortedQueries.filter(function(e){return t.test(e.name)||t.test(e.description)})},createDisabled:function(e){return 0===(e||"").trim().length},selectedItem:function(e){var t=parseInt(e),n=this.model.find(function(e){return e.id===t});return isNaN(t)?this.set("showRecentQueries",!0):this.set("showRecentQueries",!1),t<0&&this.set("editDisabled",!0),n||m},othersDirty:function(e){return!!this.model.find(function(t){return t!==e&&t.dirty})},setEverEditing:function(){this.editing&&!this.everEditing&&this.set("everEditing",!0)},addCreatedRecord:function(e){this.model.pushObject(e),this.set("selectedQueryId",Ember.get(e,"id")),this.selectedItem.set("dirty",!1),this.setProperties({showResults:!1,results:null,editing:!0})},save:function(){var e=this;return this.set("loading",!0),""===this.get("selectedItem.description")&&this.set("selectedItem.description",""),this.selectedItem.save().then(function(){e.selectedItem.markNotDirty(),e.set("editing",!1)}).catch(function(e){throw(0,s.popupAjaxError)(e),e}).finally(function(){return e.set("loading",!1)})},actions:{dummy:function(){},expandSchema:function(){this.set("hideSchema",!1)},importQuery:function(){(0,t.default)("import-query"),this.set("showCreate",!1)},showCreate:function(){this.set("showCreate",!0)},editName:function(){this.set("editing",!0)},download:function(){window.open(this.get("selectedItem.downloadUrl"),"_blank")},scrollTop:function(){window.scrollTo(0,0),this.setProperties({editing:!1,
everEditing:!1})},goHome:function(){this.setProperties({asc:null,order:null,showResults:!1,editDisabled:!1,selectedQueryId:null,sortBy:["last_run_at:desc"]}),this.send("refreshModel"),this.transitionToRoute("adminPlugins.explorer")},resetParams:function(){this.selectedItem.resetParams()},saveDefaults:function(){this.selectedItem.saveDefaults()},save:function(){this.save()},saverun:function(){var e=this;this.save().then(function(){return e.send("run")})},sortByProperty:function(e){this.sortBy[0]===e+":desc"?this.set("sortBy",[e+":asc"]):this.set("sortBy",[e+":desc"])},create:function(){var e=this,t=this.newQueryName.trim();this.setProperties({loading:!0,showCreate:!1,showRecentQueries:!1}),this.store.createRecord("query",{name:t}).save().then(function(t){return e.addCreatedRecord(t.target)}).catch(s.popupAjaxError).finally(function(){return e.set("loading",!1)})},discard:function(){var e=this;this.set("loading",!0),this.store.find("query",this.get("selectedItem.id")).then(function(t){var s=e.get("selectedItem");s.setProperties(t.getProperties(n.default.updatePropertyNames)),s.markNotDirty(),e.set("editing",!1)}).catch(s.popupAjaxError).finally(function(){return e.set("loading",!1)})},destroy:function(){var e=this,t=this.selectedItem;this.setProperties({loading:!0,showResults:!1}),this.store.destroyRecord("query",t).then(function(){return t.set("destroyed",!0)}).catch(s.popupAjaxError).finally(function(){return e.set("loading",!1)})},recover:function(){var e=this,t=this.selectedItem;this.setProperties({loading:!0,showResults:!0}),t.save().then(function(){return t.set("destroyed",!1)}).catch(s.popupAjaxError).finally(function(){e.set("loading",!1)})},run:function(){var e=this;this.get("selectedItem.dirty")||this.runDisabled||(this.setProperties({loading:!0,showResults:!1}),(0,a.ajax)("/admin/plugins/explorer/queries/"+this.get("selectedItem.id")+"/run",{type:"POST",data:{params:JSON.stringify(this.get("selectedItem.params")),explain:this.explain}}).then(function(t){if(e.set("results",t),!t.success)return void e.set("showResults",!1);e.set("showResults",!0)}).catch(function(t){e.set("showResults",!1),t.jqXHR&&422===t.jqXHR.status&&t.jqXHR.responseJSON?e.set("results",t.jqXHR.responseJSON):(0,s.popupAjaxError)(t)}).finally(function(){return e.set("loading",!1)}))}}},i(p,"filteredContent",[l],Object.getOwnPropertyDescriptor(p,"filteredContent"),p),i(p,"createDisabled",[o],Object.getOwnPropertyDescriptor(p,"createDisabled"),p),i(p,"selectedItem",[u],Object.getOwnPropertyDescriptor(p,"selectedItem"),p),i(p,"othersDirty",[c],Object.getOwnPropertyDescriptor(p,"othersDirty"),p),i(p,"setEverEditing",[d],Object.getOwnPropertyDescriptor(p,"setEverEditing"),p),p))}),define("discourse/plugins/discourse-data-explorer/discourse/controllers/import-query",["exports","ember-addons/ember-computed-decorators","discourse/mixins/modal-functionality","discourse/lib/ajax-error"],function(e,t,n,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r;e.default=Ember.Controller.extend(n.default,(a=(0,t.default)("queryFile"),r={notReady:Ember.computed.not("ready"),adminPluginsExplorer:Ember.inject.controller(),ready:function(e){var t=void 0;try{t=JSON.parse(e)}catch(e){return!1}return!!t.query},actions:{doImport:function(){var e=this,t=JSON.parse(this.queryFile).query;t.id=0,this.set("loading",!0),this.store.createRecord("query",t).save().then(function(t){e.send("closeModal"),e.set("loading",!1),e.adminPluginsExplorer.addCreatedRecord(t.target)}).catch(s.popupAjaxError)}}},function(e,t,n,s,a){var r={};return Object.keys(s).forEach(function(e){r[e]=s[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=n.slice().reverse().reduce(function(n,s){return s(e,t,n)||n},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}(r,"ready",[a],Object.getOwnPropertyDescriptor(r,"ready"),r),r))}),define("discourse/plugins/discourse-data-explorer/admin/adapters/query",["exports","admin/adapters/build-plugin"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=(0,t.default)("explorer").extend({})});
//# sourceMappingURL=/assets/plugins/discourse-data-explorer-b1a462bd0452463921b600ee6ab7796a81c5ec4712884c0068f9a09a7ed69410.js.map